#
# THIS FILE IS MANAGED BY PUPPET
# DO NOT EDIT THIS FILE MANUALLY
#
# See /usr/share/postfix/main.cf.dist for a commented, more complete version

smtpd_banner = <%= scope['::postfix::myhostname'] %>

biff = <%= scope['::postfix::biff'] %>

append_dot_mydomain = <%= scope['::postfix::append_dot_mydomain'] %>

<% if @readme_directory -%>
readme_directory = <%= scope['::postfix::readme_directory'] %>
<% end -%>

myhostname = <%= scope['::postfix::myhostname'] %>
myorigin = <%= scope['::postfix::myorigin'] %>
mynetworks = <%= scope['::postfix::mynetworks'] %>
mydestination = <%= scope['::postfix::mydestination'] %>
<% if @relay_domains -%>
relay_domains = <%= scope['::postfix::relay_domains'] %>
<% end -%>

<% if @relay_host -%>
relay_host = <%= scope['::postfix::relay_host'] %>
<% end -%>

mailbox_command = <%= scope['::postfix::mailbox_command'] %>
mailbox_size_limit = <%= scope['::postfix::mailbox_size_limit'] %>
recipient_delimiter = <%= scope['::postfix::recipient_delimiter'] %>
<% if @message_size_limit -%>
message_size_limit = <%= scope['::postfix::message_size_limit'] %>
<% end -%>


<% if @delay_warning_time -%>
delay_warning_time = <%= scope['::postfix::delay_warning_time'] %>
<% end -%>
<% if @bounce_queue_lifetime -%>
bounce_queue_lifetime = <%= scope['::postfix::bounce_queue_lifetime'] %>
<% end -%>
<% if @maximal_queue_lifetime -%>
maximal_queue_lifetime = <%= scope['::postfix::maximal_queue_lifetime'] %>
<% end -%>

<% if @transport_maps -%>
transport_maps = <%= scope['::postfix::transport_maps'] %>
<% end -%>

<% if @alias_maps -%>
alias_maps = <%= scope['::postfix::alias_maps'] %>
<% end -%>

<% if @alias_database -%>
alias_database = <%= scope['::postfix::alias_database'] %>
<% end -%>


<% if defined?$postfix::sender_canonical_maps -%>
sender_canonical_maps = <%= scope['::postfix::sender_canonical_maps'] %>
<% end -%>


<% if scope['::postfix::amavis'] == true -%>
content_filter = smtp-amavis:[127.0.0.1]:10024
<% end -%>

smtpd_helo_required = <%= scope['::postfix::smtpd_helo_required'] %>

disable_vrfy_command = <%= scope['::postfix::disable_vrfy_command'] %>

address_verify_negative_cache = <%= scope['::postfix::address_verify_negative_cache'] %>

<% if @virtual_alias_maps -%>
virtual_alias_maps = <%= scope['::postfix::virtual_alias_maps'] %>
<% end -%>

<% if @recipient_bcc_maps -%>
recipient_bcc_maps = <%= scope['::postfix::recipient_bcc_maps'] %>
<% end -%>
<% if @sender_bcc_maps -%>
sender_bcc_maps = <%= scope['::postfix::sender_bcc_maps'] %>
<% end -%>

<% if @smtpd_tls_cert_file -%>
smtpd_tls_cert_file = <%= scope['::postfix::smtpd_tls_cert_file'] %>
<% end -%>
<% if @smtpd_tls_key_file -%>
smtpd_tls_key_file = <%= scope['::postfix::smtpd_tls_key_file'] %>
<% end -%>
<% if @smtpd_CAfile -%>
smtpd_CAfile = <%= scope['::postfix::smtpd_CAfile'] %>
<% end -%>
<% if @smtpd_use_tls -%>
smtpd_use_tls = <%= scope['::postfix::smtpd_use_tls'] %>
<% end -%>
<% if @smtpd_tls_security_level -%>
smtpd_tls_security_level = <%= scope['::postfix::smtpd_tls_security_level'] %>
<% end -%>
<% if @smtpd_tls_auth_only -%>
smtpd_tls_auth_only = <%= scope['::postfix::smtpd_tls_auth_only'] %>
<% end -%>
<% if @smtpd_tls_session_cache_database -%>
smtpd_tls_session_cache_database = <%= scope['::postfix::smtpd_tls_session_cache_database'] %>
<% end -%>
<% if @smtpd_tls_mandatory_protocols -%>
smtpd_tls_mandatory_protocols = <%= scope['::postfix::smtpd_tls_mandatory_protocols'] %>
<% end -%>
<% if @smtpd_tls_mandatory_ciphers -%>
smtpd_tls_mandatory_ciphers = <%= scope['::postfix::smtpd_tls_mandatory_ciphers'] %>
<% end -%>
<% if @smtpd_tls_protocols -%>
smtpd_tls_protocols = <%= scope['::postfix::smtpd_tls_protocols'] %>
<% end -%>
<% if @tls_medium_cipherlist -%>
tls_medium_cipherlist = <%= scope['::postfix::tls_medium_cipherlist'] %>
<% end -%>
<% if @smtp_tls_cert_file -%>
smtp_tls_cert_file = <%= scope['::postfix::smtp_tls_cert_file'] %>
<% end -%>
<% if @smtp_tls_key_file -%>
smtp_tls_key_file = <%= scope['::postfix::smtp_tls_key_file'] %>
<% end -%>
<% if @smtp_tls_security_level -%>
smtp_tls_security_level = <%= scope['::postfix::smtp_tls_security_level'] %>
<% end -%>
<% if @smtp_tls_session_cache_database -%>
smtp_tls_session_cache_database = <%= scope['::postfix::smtp_tls_session_cache_database'] %>
<% end -%>
<% if @tls_high_cipherlist -%>
tls_high_cipherlist = <%= scope['::postfix::tls_high_cipherlist'] %>
<% end -%>
<% if @smtpd_tls_loglevel -%>
smtpd_tls_loglevel = <%= scope['::postfix::smtpd_tls_loglevel'] %>
<% end -%>
<% if @smtp_tls_loglevel -%>
smtp_tls_loglevel = <%= scope['::postfix::smtp_tls_loglevel'] %>
<% end -%>
<% if @smtpd_delay_reject -%>
smtpd_delay_reject = <%= scope['::postfix::smtpd_delay_reject'] %>
<% end -%>
<% if @smtpd_tls_eecdh_grade -%>
smtpd_tls_eecdh_grade = <%= scope['::postfix::smtpd_tls_eecdh_grade'] %>
<% end -%>

<% if @smtpd_client_restrictions -%>
smtpd_client_restrictions=
<% @smtpd_client_restrictions.each do |rule| -%>
        <%= rule %>,
<% end -%>
<% end -%>

<% if @smtpd_helo_restrictions -%>
smtpd_helo_restrictions=
<% @smtpd_helo_restrictions.each do |rule| -%>
        <%= rule %>,
<% end -%>
<% end -%>

<% if @smtpd_sender_restrictions -%>
smtpd_sender_restrictions=
<% @smtpd_sender_restrictions.each do |rule| -%>
        <%= rule %>,
<% end -%>
<% end -%>

<% if @smtpd_recipient_restrictions -%>
smtpd_recipient_restrictions=
<% @smtpd_recipient_restrictions.each do |rule| -%>
        <%= rule %>,
<% end -%>
<% end -%>

<% if @smtpd_data_restrictions -%>
smtpd_data_restrictions=
<% @smtpd_data_restrictions.each do |rule| -%>
        <%= rule %>,
<% end -%>
<% end -%>

<% if scope['::postfix::postscreen'] == true -%>
postscreen_access_list = permit_mynetworks, cidr:/etc/postfix/postscreen_access.cidr
postscreen_greet_banner =  mail.
postscreen_greet_wait = 4s
postscreen_greet_action = enforce
postscreen_pipelining_enable = yes
postscreen_pipelining_action = enforce
postscreen_non_smtp_command_enable = yes
postscreen_dnsbl_sites = bl.spamcop.net*1 dnsbl.sorbs.net*1 ix.dnsbl.manitu.net*1 rhsbl.sorbs.net*1 dnsbl.inps.de*1 dnsbl-1.uceprotect.net*1 dnswl.inps.de*-2 wl.mailspike.net*-1
postscreen_dnsbl_threshold = 3
postscreen_dnsbl_whitelist_threshold = -1
postscreen_dnsbl_action = enforce
<% end -%>

<% if scope['::postfix::rspamd'] == true -%>
milter_mail_macros = i {mail_addr} {client_addr} {client_name} {auth_authen}
smtpd_milters = unix:/run/rmilter/rmilter.sock
milter_protocol = 6
milter_default_action = accept
<% end -%>

<% if @inet_interfaces -%>
<% if @inet_interfaces =~ Array -%>
inet_interfaces = <% @inet_interfaces.each do |inetif| -%><%= inetif -%>,<% end -%>
<% else %>
inet_interfaces = <%= @inet_interfaces %>
<% end -%>
<% end -%>

